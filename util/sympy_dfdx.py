# use sumpy to generate the detail code
import sympy
from sympy import *

dFdx = sympy.zeros(9,12)
B00 = Symbol('B00')
B01 = Symbol('B01')
B02 = Symbol('B02')
B10 = Symbol('B10')
B11 = Symbol('B11')
B12 = Symbol('B12')
B20 = Symbol('B20')
B21 = Symbol('B21')
B22 = Symbol('B22')
t1 = - B00 - B10 - B20
t2 = - B01 - B11 - B21
t3 = - B02 - B12 - B22
dFdx[0, 0] = t1
dFdx[0, 3] = B00
dFdx[0, 6] = B10
dFdx[0, 9] = B20

dFdx[1, 1] = t1
dFdx[1, 4] = B00
dFdx[1, 7] = B10
dFdx[1, 10] = B20

dFdx[2, 2] = t1
dFdx[2, 5] = B00
dFdx[2, 8] = B10
dFdx[2, 11] = B20

dFdx[3, 0] = t2
dFdx[3, 3] = B01
dFdx[3, 6] = B11
dFdx[3, 9] = B21

dFdx[4, 1] = t2
dFdx[4, 4] = B01
dFdx[4, 7] = B11
dFdx[4, 10] = B21

dFdx[5, 2] = t2
dFdx[5, 5] = B01
dFdx[5, 8] = B11
dFdx[5, 11] = B21

dFdx[6, 0] = t3
dFdx[6, 3] = B02
dFdx[6, 6] = B12
dFdx[6, 9] = B22

dFdx[7, 1] = t3
dFdx[7, 4] = B02
dFdx[7, 7] = B12
dFdx[7, 10] = B22

dFdx[8, 2] = t3
dFdx[8, 5] = B02
dFdx[8, 8] = B12
dFdx[8, 11] = B22

def test_1():
    # dFdx_transpose @ dFdx : 12x9 @ 9x12 -> 12x12 -> diag 3x3 of it
    dFdx_T_dFdx = (dFdx.transpose()).multiply(dFdx)
    dFdx_T_dFdx_simp = simplify(dFdx_T_dFdx)
    print('---------------------------------')
    for i in range(4):
        print(dFdx_T_dFdx_simp[i*3, i*3:i*3+3])
        print(dFdx_T_dFdx_simp[i*3+1, i*3:i*3+3])
        print(dFdx_T_dFdx_simp[i*3+2, i*3:i*3+3])

def test2():
    # dFdx_transpose @ p : 12x9 @ 9x1 -> 12x1
    p0, p1, p2,  p3,  p4,  p5,  p6,  p7,  p8 = sympy.symbols('p0,  p1,  p2,  p3,  p4,  p5,  p6,  p7,  p8')
    p =  sympy.Matrix([p0, p1, p2, p3, p4, p5, p6, p7, p8])
    R = dFdx.transpose().multiply(p)
    R_simp = simplify(R)
    print(R_simp)

def test3():
    # dFdx @ p : 9x12 @ 12x1 -> 9x1
    p0, p1,  p2,  p3,  p4,  p5,  p6,  p7,  p8,  p9,  p10, p11 = sympy.symbols('p0,  p1,  p2,  p3,  p4,  p5,  p6,  p7,  p8,  p9,  p10, p11')
    p =  sympy.Matrix([p0, p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11])
    print(p.shape)
    R3 = dFdx.multiply(p)
    R3_simp = simplify(R3)
    print(R3_simp)

def test4():
    # F 3x3, dJdF 3x3 -> vec(dJdF) 9x1
    F00, F01,  F02,  F10,  F11,  F12,  F20,  F21,  F22 = sympy.symbols('F00,  F01,  F02,  F10,  F11,  F12,  F20,  F21,  F22')
    F0 = sympy.Matrix([F00, F10, F20])
    F1 = sympy.Matrix([F01, F11, F21])
    F2 = sympy.Matrix([F02, F12, F22])

    F1_cross_F2 = sympy.Matrix([F1[1] * F2[2] - F1[2] * F2[1], F1[2] * F2[0] - F1[0] * F2[2],  F1[0] * F2[1] - F1[1] * F2[0]])
    F2_cross_F0 = sympy.Matrix([F2[1] * F0[2] - F2[2] * F0[1], F2[2] * F0[0] - F2[0] * F0[2],  F2[0] * F0[1] - F2[1] * F0[0]])
    F0_cross_F1 = sympy.Matrix([F0[1] * F1[2] - F0[2] * F1[1], F0[2] * F1[0] - F0[0] * F1[2],  F0[0] * F1[1] - F0[1] * F1[0]])
    print(F1_cross_F2)
    print(F2_cross_F0)
    print(F0_cross_F1)

    dJdF = sympy.Matrix([ [F1_cross_F2[0], F2_cross_F0[0], F0_cross_F1[0]],
                          [F1_cross_F2[1], F2_cross_F0[1], F0_cross_F1[1]],
                          [F1_cross_F2[2], F2_cross_F0[2], F0_cross_F1[2]]])

    dJdF_simp = simplify(dJdF)
    print(dJdF_simp)
    print('---------------------------------')
    vec_dJdF = sympy.Matrix([F1_cross_F2[0],F1_cross_F2[1],F1_cross_F2[2],F2_cross_F0[0],F2_cross_F0[1],F2_cross_F0[2],F0_cross_F1[0],F0_cross_F1[1],F0_cross_F1[2]])
    vec_dJdF_simp = simplify(vec_dJdF)
    print(vec_dJdF_simp)

def test5():
    # N 3x3 -> vec(N) 9x1 ; dFdx_transpose @ vec(N) : 12x9 @ 9x1 -> 12x1
    N00, N01, N02, N10, N11, N12, N20, N21, N22 = sympy.symbols('N00, N01, N02, N10, N11, N12, N20, N21, N22')
    vec_N = sympy.Matrix([N00,N10,N20,N01,N11,N21,N02,N12,N22])
    print(vec_N.shape)
    R = dFdx.transpose().multiply(vec_N)
    R_simp = simplify(R)
    print(R_simp)

def test6():
    # diag( dFdx_transpose @ dFdx) : 12x9 @ 9x12 -> 12x12 -> 12x1
    dFdxTdFdx = (sympy.transpose(dFdx)).multiply(dFdx)
    print(sympy.shape(dFdxTdFdx))
    for i in range(12):
        print(i, dFdxTdFdx[i, i])

def test7():
    # H3 : 9x9; dFdx_transpose @ H3 @ dFdx : 12x9 @ 9x9 @ 9x12 -> 12x12
    # diagH , diagH3x3,
    # p_transpose @ H3 @ p 1x9 @ 9x9 @ 9x1 -> 1x1
    hess = sympy.zeros(9, 9)
    F00 = sympy.Symbol('F00')
    F01 = sympy.Symbol('F01')
    F02 = sympy.Symbol('F02')
    F10 = sympy.Symbol('F10')
    F11 = sympy.Symbol('F11')
    F12 = sympy.Symbol('F12')
    F20 = sympy.Symbol('F20')
    F21 = sympy.Symbol('F21')
    F22 = sympy.Symbol('F22')
    f0hat = sympy.Matrix([[0, -F20, F10], [F20, 0, -F00], [-F10, F00, 0]])
    f1hat = sympy.Matrix([[0, -F21, F11], [F21, 0, -F01], [-F11, F01, 0]])
    f2hat = sympy.Matrix([[0, -F22, F12], [F22, 0, -F02], [-F12, F02, 0]])
    # print(f0hat, f1hat, f2hat)
    hessJ = sympy.zeros(9, 9)
    for j in range(3):
        for i in range(3):
            hessJ[i, j + 3] = -f2hat[i, j]
            hessJ[i + 3, j] = f2hat[i, j]

            hessJ[i, j + 6] = f1hat[i, j]
            hessJ[i + 6, j] = -f1hat[i, j]

            hessJ[i + 3, j + 6] = -f0hat[i, j]
            hessJ[i + 6, j + 3] = f0hat[i, j]
    print('H3ï¼š ')
    print(simplify(hessJ))
    Hessian = ((dFdx.transpose()).multiply(hessJ)).multiply(dFdx)
    for i in range(12):
        print('diag H ', i, Hessian[i,i])

    Hessian_simplify = simplify(Hessian)
    print(Hessian_simplify)
    for i in range(4):
        print('diagH3x3 ', Hessian_simplify[i*3: (i+1)*3,i*3: (i+1)*3])



    D = sympy.zeros(1,9)
    d0, d1, d2, d3, d4, d5, d6, d7, d8 = sympy.symbols('d0 d1 d2 d3 d4 d5 d6 d7 d8')
    D[0,0] = d0
    D[0,1] = d1
    D[0,2] = d2
    D[0,3] = d3
    D[0,4] = d4
    D[0,5] = d5
    D[0,6] = d6
    D[0,7] = d7
    D[0,8] = d8
    T = D.multiply(hessJ).multiply(D.transpose())
    T_simplify = simplify(T)
    print('T ', sympy.shape(T), T_simplify)

def test8():
    # diag h4
    la0 = sympy.Symbol('la0')
    la1 = sympy.Symbol('la1')
    la2 = sympy.Symbol('la2')

    U00 = sympy.Symbol('U00')
    U01 = sympy.Symbol('U01')
    U02 = sympy.Symbol('U02')
    U10 = sympy.Symbol('U10')
    U11 = sympy.Symbol('U11')
    U12 = sympy.Symbol('U12')
    U20 = sympy.Symbol('U20')
    U21 = sympy.Symbol('U21')
    U22 = sympy.Symbol('U22')

    V00 = sympy.Symbol('V00')
    V01 = sympy.Symbol('V01')
    V02 = sympy.Symbol('V02')
    V10 = sympy.Symbol('V10')
    V11 = sympy.Symbol('V11')
    V12 = sympy.Symbol('V12')
    V20 = sympy.Symbol('V20')
    V21 = sympy.Symbol('V21')
    V22 = sympy.Symbol('V22')
    U = sympy.Matrix([[U00, U01, U02], [U10, U11, U12], [U20, U21, U22]])
    V = sympy.Matrix([[V00, V01, V02], [V10, V11, V12], [V20, V21, V22]])
    tmp0 = sympy.Matrix([[0, -1, 0],[1,0,0],[0,0,0]])
    tmp1 = sympy.Matrix([[0, 0, 0],[0,0,1],[0,-1,0]])
    tmp2 = sympy.Matrix([[0, 0, 1],[0,0,0],[-1,0,0]])
    Q0 = 1 / sympy.sqrt(2) * U.multiply(tmp0).multiply(V.transpose())
    Q1 = 1 / sympy.sqrt(2) * U.multiply(tmp1).multiply(V.transpose())
    Q2 = 1 / sympy.sqrt(2) * U.multiply(tmp2).multiply(V.transpose())
    print(Q0, Q1, Q2)
    vec_Q0 = sympy.Matrix([Q0[0,0], Q0[1,0], Q0[2,0], Q0[0,1], Q0[1,1], Q0[2,1], Q0[0,2], Q0[1,2], Q0[2,2]])
    vec_Q1 = sympy.Matrix([Q1[0,0], Q1[1,0], Q1[2,0], Q1[0,1], Q1[1,1], Q1[2,1], Q1[0,2], Q1[1,2], Q1[2,2]])
    vec_Q2 = sympy.Matrix([Q2[0,0], Q2[1,0], Q2[2,0], Q2[0,1], Q2[1,1], Q2[2,1], Q2[0,2], Q2[1,2], Q2[2,2]])
    print(vec_Q0.shape)
    tmp0 = (dFdx.transpose().multiply(vec_Q0))
    tmp00 = la0 * tmp0.multiply_elementwise(tmp0)

    tmp1 = (dFdx.transpose().multiply(vec_Q1))
    tmp11 = la1 * tmp1.multiply_elementwise(tmp1)

    tmp2 = (dFdx.transpose().multiply(vec_Q2))
    tmp22 = la2 * tmp2.multiply_elementwise(tmp2)
    h4 = tmp00 + tmp11 + tmp22
    h4_simp = simplify(h4)
    # print(h4_simp)
    for i in range(12):
        print(h4_simp[i])

def test9():
    # pT h4 p
    la0 = sympy.Symbol('la0')
    la1 = sympy.Symbol('la1')
    la2 = sympy.Symbol('la2')

    U00 = sympy.Symbol('U00')
    U01 = sympy.Symbol('U01')
    U02 = sympy.Symbol('U02')
    U10 = sympy.Symbol('U10')
    U11 = sympy.Symbol('U11')
    U12 = sympy.Symbol('U12')
    U20 = sympy.Symbol('U20')
    U21 = sympy.Symbol('U21')
    U22 = sympy.Symbol('U22')

    V00 = sympy.Symbol('V00')
    V01 = sympy.Symbol('V01')
    V02 = sympy.Symbol('V02')
    V10 = sympy.Symbol('V10')
    V11 = sympy.Symbol('V11')
    V12 = sympy.Symbol('V12')
    V20 = sympy.Symbol('V20')
    V21 = sympy.Symbol('V21')
    V22 = sympy.Symbol('V22')
    U = sympy.Matrix([[U00, U01, U02], [U10, U11, U12], [U20, U21, U22]])
    V = sympy.Matrix([[V00, V01, V02], [V10, V11, V12], [V20, V21, V22]])
    tmp0 = sympy.Matrix([[0, -1, 0],[1,0,0],[0,0,0]])
    tmp1 = sympy.Matrix([[0, 0, 0],[0,0,1],[0,-1,0]])
    tmp2 = sympy.Matrix([[0, 0, 1],[0,0,0],[-1,0,0]])
    Q0 = 1 / sympy.sqrt(2) * U.multiply(tmp0).multiply(V.transpose())
    Q1 = 1 / sympy.sqrt(2) * U.multiply(tmp1).multiply(V.transpose())
    Q2 = 1 / sympy.sqrt(2) * U.multiply(tmp2).multiply(V.transpose())
    vec_Q0 = sympy.Matrix([Q0[0,0], Q0[1,0], Q0[2,0], Q0[0,1], Q0[1,1], Q0[2,1], Q0[0,2], Q0[1,2], Q0[2,2]])
    vec_Q1 = sympy.Matrix([Q1[0,0], Q1[1,0], Q1[2,0], Q1[0,1], Q1[1,1], Q1[2,1], Q1[0,2], Q1[1,2], Q1[2,2]])
    vec_Q2 = sympy.Matrix([Q2[0,0], Q2[1,0], Q2[2,0], Q2[0,1], Q2[1,1], Q2[2,1], Q2[0,2], Q2[1,2], Q2[2,2]])
    print(vec_Q0.shape)

    d0, d1, d2, d3, d4, d5, d6, d7, d8 = sympy.symbols('d0 d1 d2 d3 d4 d5 d6 d7 d8')
    d = sympy.Matrix([d0, d1, d2, d3, d4, d5, d6, d7, d8]) #9x1
    dTh4d = la0 * (vec_Q0.transpose().multiply(d)[0,0])**2 + la1 * (vec_Q1.transpose().multiply(d)[0,0])**2 + la2 * (vec_Q2.transpose().multiply(d)[0,0])**2
    print(simplify(dTh4d))

def flatten_vector(A):
    A_flatten = sympy.Matrix([A[0,0],A[1,0],A[2,0],A[0,1],A[1,1],A[2,1],A[0,2],A[1,2],A[2,2]])
    return A_flatten.transpose()

def test10():
    # obtain the spd matrix of H3
    U00 = sympy.Symbol('U00')
    U01 = sympy.Symbol('U01')
    U02 = sympy.Symbol('U02')
    U10 = sympy.Symbol('U10')
    U11 = sympy.Symbol('U11')
    U12 = sympy.Symbol('U12')
    U20 = sympy.Symbol('U20')
    U21 = sympy.Symbol('U21')
    U22 = sympy.Symbol('U22')

    V00 = sympy.Symbol('V00')
    V01 = sympy.Symbol('V01')
    V02 = sympy.Symbol('V02')
    V10 = sympy.Symbol('V10')
    V11 = sympy.Symbol('V11')
    V12 = sympy.Symbol('V12')
    V20 = sympy.Symbol('V20')
    V21 = sympy.Symbol('V21')
    V22 = sympy.Symbol('V22')
    l0 = sympy.Symbol('l0')
    l1 = sympy.Symbol('l1')
    l2 = sympy.Symbol('l2')
    sig_x = sympy.Symbol('sig_x')
    sig_y = sympy.Symbol('sig_y')
    sig_z = sympy.Symbol('sig_z')
    U = sympy.Matrix([[U00, U01, U02], [U10, U11, U12], [U20, U21, U22]])
    V = sympy.Matrix([[V00, V01, V02], [V10, V11, V12], [V20, V21, V22]])
    E0 =  sympy.Matrix([[1, 0, 0], [0, 0, 0], [0, 0, 0]])
    E1 =  sympy.Matrix([[0, 0, 0], [0, 1, 0], [0, 0, 0]])
    E2 =  sympy.Matrix([[0, 0, 0], [0, 0, 0], [0, 0, 1]])
    E3 = sympy.Matrix([[0, -1, 0],[1,0,0],[0,0,0]])
    E4 = sympy.Matrix([[0, 0, 0],[0,0,1],[0,-1,0]])
    E5 = sympy.Matrix([[0, 0, 1],[0,0,0],[-1,0,0]])
    E6 = sympy.Matrix([[0, 1, 0],[1,0,0],[0,0,0]])
    E7 = sympy.Matrix([[0, 0, 0],[0,0,1],[0,1,0]])
    E8 = sympy.Matrix([[0, 0, 1],[0,0,0],[1,0,0]])
    Q0 = ((sig_x*sig_z+sig_y*l0) * (U.multiply(E0)).multiply(V.transpose())
          + (sig_y * sig_z + sig_x * l0) * (U.multiply(E1)).multiply(V.transpose())
          + (l0**2 -sig_z**2) * (U.multiply(E2)).multiply(V.transpose()))
    Q1 = ((sig_x*sig_z+sig_y*l1) * (U.multiply(E0)).multiply(V.transpose())
          + (sig_y * sig_z + sig_x * l1) * (U.multiply(E1)).multiply(V.transpose())
          + (l1**2 -sig_z**2) * (U.multiply(E2)).multiply(V.transpose()))
    Q2 = ((sig_x*sig_z+sig_y*l2) * (U.multiply(E0)).multiply(V.transpose())
          + (sig_y * sig_z + sig_x * l2) * (U.multiply(E1)).multiply(V.transpose())
          + (l2**2 -sig_z**2) * (U.multiply(E2)).multiply(V.transpose()))
    Q3 = 1/sympy.sqrt(2) * (U.multiply(E3)).multiply(V.transpose())
    Q4 = 1/sympy.sqrt(2) * (U.multiply(E4)).multiply(V.transpose())
    Q5 = 1/sympy.sqrt(2) * (U.multiply(E5)).multiply(V.transpose())
    Q6 = 1/sympy.sqrt(2) * (U.multiply(E6)).multiply(V.transpose())
    Q7 = 1/sympy.sqrt(2) * (U.multiply(E7)).multiply(V.transpose())
    Q8 = 1/sympy.sqrt(2) * (U.multiply(E8)).multiply(V.transpose())
    vec_Q0 = flatten_vector(Q0)
    vec_Q1 = flatten_vector(Q1)
    vec_Q2 = flatten_vector(Q2)
    vec_Q3 = flatten_vector(Q3)
    vec_Q4 = flatten_vector(Q4)
    vec_Q5 = flatten_vector(Q5)
    vec_Q6 = flatten_vector(Q6)
    vec_Q7 = flatten_vector(Q7)
    vec_Q8 = flatten_vector(Q8)

    # H = l0 * Q0 + l1 * Q1 + l2 * Q2 + sig_z * Q3 + sig_x * Q4 + sig_y * Q5 - sig_z * Q6 - sig_x * Q7 - sig_y * Q8
    H = (l0 * (vec_Q0.transpose()).multiply(vec_Q0) +
         l1 * (vec_Q1.transpose()).multiply(vec_Q1) +
         l2 * (vec_Q2.transpose()).multiply(vec_Q2) +
         sig_z * (vec_Q3.transpose()).multiply(vec_Q3) +
         sig_x * (vec_Q4.transpose()).multiply(vec_Q4) +
         sig_y * (vec_Q5.transpose()).multiply(vec_Q5) -
         sig_z * (vec_Q6.transpose()).multiply(vec_Q6) -
         sig_x * (vec_Q7.transpose()).multiply(vec_Q7) -
         sig_y * (vec_Q8.transpose()).multiply(vec_Q8))
    H_simp = simplify(H)
    print(H_simp.shape)
    d0, d1, d2, d3, d4, d5, d6, d7, d8 = sympy.symbols('d0 d1 d2 d3 d4 d5 d6 d7 d8')
    d = sympy.Matrix([d0, d1, d2, d3, d4, d5, d6, d7, d8]) #9x1
    print(d.shape)
    ret = (d.transpose().multiply(H_simp)).multiply(d)
    print(ret.shape)
    print(simplify(ret))
    ret_value = d0*(d0*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))**2 + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))**2 + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))**2 + sig_x*(U01*V02 - U02*V01)**2 - sig_x*(U01*V02 + U02*V01)**2 + sig_y*(U00*V02 - U02*V00)**2 - sig_y*(U00*V02 + U02*V00)**2 + sig_z*(U00*V01 - U01*V00)**2 - sig_z*(U00*V01 + U01*V00)**2) + d1*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U11*V02 - U12*V01) - sig_x*(U01*V02 + U02*V01)*(U11*V02 + U12*V01) + sig_y*(U00*V02 - U02*V00)*(U10*V02 - U12*V00) - sig_y*(U00*V02 + U02*V00)*(U10*V02 + U12*V00) + sig_z*(U00*V01 - U01*V00)*(U10*V01 - U11*V00) - sig_z*(U00*V01 + U01*V00)*(U10*V01 + U11*V00)) + d2*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U21*V02 - U22*V01) - sig_x*(U01*V02 + U02*V01)*(U21*V02 + U22*V01) + sig_y*(U00*V02 - U02*V00)*(U20*V02 - U22*V00) - sig_y*(U00*V02 + U02*V00)*(U20*V02 + U22*V00) + sig_z*(U00*V01 - U01*V00)*(U20*V01 - U21*V00) - sig_z*(U00*V01 + U01*V00)*(U20*V01 + U21*V00)) + d3*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U01*V12 - U02*V11) - sig_x*(U01*V02 + U02*V01)*(U01*V12 + U02*V11) + sig_y*(U00*V02 - U02*V00)*(U00*V12 - U02*V10) - sig_y*(U00*V02 + U02*V00)*(U00*V12 + U02*V10) + sig_z*(U00*V01 - U01*V00)*(U00*V11 - U01*V10) - sig_z*(U00*V01 + U01*V00)*(U00*V11 + U01*V10)) + d4*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U11*V12 - U12*V11) - sig_x*(U01*V02 + U02*V01)*(U11*V12 + U12*V11) + sig_y*(U00*V02 - U02*V00)*(U10*V12 - U12*V10) - sig_y*(U00*V02 + U02*V00)*(U10*V12 + U12*V10) + sig_z*(U00*V01 - U01*V00)*(U10*V11 - U11*V10) - sig_z*(U00*V01 + U01*V00)*(U10*V11 + U11*V10)) + d5*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U21*V12 - U22*V11) - sig_x*(U01*V02 + U02*V01)*(U21*V12 + U22*V11) + sig_y*(U00*V02 - U02*V00)*(U20*V12 - U22*V10) - sig_y*(U00*V02 + U02*V00)*(U20*V12 + U22*V10) + sig_z*(U00*V01 - U01*V00)*(U20*V11 - U21*V10) - sig_z*(U00*V01 + U01*V00)*(U20*V11 + U21*V10)) + d6*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U01*V22 - U02*V21) - sig_x*(U01*V02 + U02*V01)*(U01*V22 + U02*V21) + sig_y*(U00*V02 - U02*V00)*(U00*V22 - U02*V20) - sig_y*(U00*V02 + U02*V00)*(U00*V22 + U02*V20) + sig_z*(U00*V01 - U01*V00)*(U00*V21 - U01*V20) - sig_z*(U00*V01 + U01*V00)*(U00*V21 + U01*V20)) + d7*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U11*V22 - U12*V21) - sig_x*(U01*V02 + U02*V01)*(U11*V22 + U12*V21) + sig_y*(U00*V02 - U02*V00)*(U10*V22 - U12*V20) - sig_y*(U00*V02 + U02*V00)*(U10*V22 + U12*V20) + sig_z*(U00*V01 - U01*V00)*(U10*V21 - U11*V20) - sig_z*(U00*V01 + U01*V00)*(U10*V21 + U11*V20)) + d8*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U21*V22 - U22*V21) - sig_x*(U01*V02 + U02*V01)*(U21*V22 + U22*V21) + sig_y*(U00*V02 - U02*V00)*(U20*V22 - U22*V20) - sig_y*(U00*V02 + U02*V00)*(U20*V22 + U22*V20) + sig_z*(U00*V01 - U01*V00)*(U20*V21 - U21*V20) - sig_z*(U00*V01 + U01*V00)*(U20*V21 + U21*V20)))/2 + d1*(d0*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U11*V02 - U12*V01) - sig_x*(U01*V02 + U02*V01)*(U11*V02 + U12*V01) + sig_y*(U00*V02 - U02*V00)*(U10*V02 - U12*V00) - sig_y*(U00*V02 + U02*V00)*(U10*V02 + U12*V00) + sig_z*(U00*V01 - U01*V00)*(U10*V01 - U11*V00) - sig_z*(U00*V01 + U01*V00)*(U10*V01 + U11*V00)) + d1*(2*l0*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2))**2 + 2*l1*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2))**2 + 2*l2*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2))**2 + sig_x*(U11*V02 - U12*V01)**2 - sig_x*(U11*V02 + U12*V01)**2 + sig_y*(U10*V02 - U12*V00)**2 - sig_y*(U10*V02 + U12*V00)**2 + sig_z*(U10*V01 - U11*V00)**2 - sig_z*(U10*V01 + U11*V00)**2) + d2*(2*l0*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U11*V02 - U12*V01)*(U21*V02 - U22*V01) - sig_x*(U11*V02 + U12*V01)*(U21*V02 + U22*V01) + sig_y*(U10*V02 - U12*V00)*(U20*V02 - U22*V00) - sig_y*(U10*V02 + U12*V00)*(U20*V02 + U22*V00) + sig_z*(U10*V01 - U11*V00)*(U20*V01 - U21*V00) - sig_z*(U10*V01 + U11*V00)*(U20*V01 + U21*V00)) + d3*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U11*V02 - U12*V01) - sig_x*(U01*V12 + U02*V11)*(U11*V02 + U12*V01) + sig_y*(U00*V12 - U02*V10)*(U10*V02 - U12*V00) - sig_y*(U00*V12 + U02*V10)*(U10*V02 + U12*V00) + sig_z*(U00*V11 - U01*V10)*(U10*V01 - U11*V00) - sig_z*(U00*V11 + U01*V10)*(U10*V01 + U11*V00)) + d4*(2*l0*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2))*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2)) + 2*l1*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2))*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2)) + 2*l2*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2))*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2)) + sig_x*(U11*V02 - U12*V01)*(U11*V12 - U12*V11) - sig_x*(U11*V02 + U12*V01)*(U11*V12 + U12*V11) + sig_y*(U10*V02 - U12*V00)*(U10*V12 - U12*V10) - sig_y*(U10*V02 + U12*V00)*(U10*V12 + U12*V10) + sig_z*(U10*V01 - U11*V00)*(U10*V11 - U11*V10) - sig_z*(U10*V01 + U11*V00)*(U10*V11 + U11*V10)) + d5*(2*l0*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U11*V02 - U12*V01)*(U21*V12 - U22*V11) - sig_x*(U11*V02 + U12*V01)*(U21*V12 + U22*V11) + sig_y*(U10*V02 - U12*V00)*(U20*V12 - U22*V10) - sig_y*(U10*V02 + U12*V00)*(U20*V12 + U22*V10) + sig_z*(U10*V01 - U11*V00)*(U20*V11 - U21*V10) - sig_z*(U10*V01 + U11*V00)*(U20*V11 + U21*V10)) + d6*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U11*V02 - U12*V01) - sig_x*(U01*V22 + U02*V21)*(U11*V02 + U12*V01) + sig_y*(U00*V22 - U02*V20)*(U10*V02 - U12*V00) - sig_y*(U00*V22 + U02*V20)*(U10*V02 + U12*V00) + sig_z*(U00*V21 - U01*V20)*(U10*V01 - U11*V00) - sig_z*(U00*V21 + U01*V20)*(U10*V01 + U11*V00)) + d7*(2*l0*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2))*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2)) + 2*l1*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2))*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2)) + 2*l2*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2))*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2)) + sig_x*(U11*V02 - U12*V01)*(U11*V22 - U12*V21) - sig_x*(U11*V02 + U12*V01)*(U11*V22 + U12*V21) + sig_y*(U10*V02 - U12*V00)*(U10*V22 - U12*V20) - sig_y*(U10*V02 + U12*V00)*(U10*V22 + U12*V20) + sig_z*(U10*V01 - U11*V00)*(U10*V21 - U11*V20) - sig_z*(U10*V01 + U11*V00)*(U10*V21 + U11*V20)) + d8*(2*l0*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U11*V02 - U12*V01)*(U21*V22 - U22*V21) - sig_x*(U11*V02 + U12*V01)*(U21*V22 + U22*V21) + sig_y*(U10*V02 - U12*V00)*(U20*V22 - U22*V20) - sig_y*(U10*V02 + U12*V00)*(U20*V22 + U22*V20) + sig_z*(U10*V01 - U11*V00)*(U20*V21 - U21*V20) - sig_z*(U10*V01 + U11*V00)*(U20*V21 + U21*V20)))/2 + d2*(d0*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U21*V02 - U22*V01) - sig_x*(U01*V02 + U02*V01)*(U21*V02 + U22*V01) + sig_y*(U00*V02 - U02*V00)*(U20*V02 - U22*V00) - sig_y*(U00*V02 + U02*V00)*(U20*V02 + U22*V00) + sig_z*(U00*V01 - U01*V00)*(U20*V01 - U21*V00) - sig_z*(U00*V01 + U01*V00)*(U20*V01 + U21*V00)) + d1*(2*l0*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U11*V02 - U12*V01)*(U21*V02 - U22*V01) - sig_x*(U11*V02 + U12*V01)*(U21*V02 + U22*V01) + sig_y*(U10*V02 - U12*V00)*(U20*V02 - U22*V00) - sig_y*(U10*V02 + U12*V00)*(U20*V02 + U22*V00) + sig_z*(U10*V01 - U11*V00)*(U20*V01 - U21*V00) - sig_z*(U10*V01 + U11*V00)*(U20*V01 + U21*V00)) + d2*(2*l0*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2))**2 + 2*l1*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2))**2 + 2*l2*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2))**2 + sig_x*(U21*V02 - U22*V01)**2 - sig_x*(U21*V02 + U22*V01)**2 + sig_y*(U20*V02 - U22*V00)**2 - sig_y*(U20*V02 + U22*V00)**2 + sig_z*(U20*V01 - U21*V00)**2 - sig_z*(U20*V01 + U21*V00)**2) + d3*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U21*V02 - U22*V01) - sig_x*(U01*V12 + U02*V11)*(U21*V02 + U22*V01) + sig_y*(U00*V12 - U02*V10)*(U20*V02 - U22*V00) - sig_y*(U00*V12 + U02*V10)*(U20*V02 + U22*V00) + sig_z*(U00*V11 - U01*V10)*(U20*V01 - U21*V00) - sig_z*(U00*V11 + U01*V10)*(U20*V01 + U21*V00)) + d4*(2*l0*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U11*V12 - U12*V11)*(U21*V02 - U22*V01) - sig_x*(U11*V12 + U12*V11)*(U21*V02 + U22*V01) + sig_y*(U10*V12 - U12*V10)*(U20*V02 - U22*V00) - sig_y*(U10*V12 + U12*V10)*(U20*V02 + U22*V00) + sig_z*(U10*V11 - U11*V10)*(U20*V01 - U21*V00) - sig_z*(U10*V11 + U11*V10)*(U20*V01 + U21*V00)) + d5*(2*l0*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U21*V02 - U22*V01)*(U21*V12 - U22*V11) - sig_x*(U21*V02 + U22*V01)*(U21*V12 + U22*V11) + sig_y*(U20*V02 - U22*V00)*(U20*V12 - U22*V10) - sig_y*(U20*V02 + U22*V00)*(U20*V12 + U22*V10) + sig_z*(U20*V01 - U21*V00)*(U20*V11 - U21*V10) - sig_z*(U20*V01 + U21*V00)*(U20*V11 + U21*V10)) + d6*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U21*V02 - U22*V01) - sig_x*(U01*V22 + U02*V21)*(U21*V02 + U22*V01) + sig_y*(U00*V22 - U02*V20)*(U20*V02 - U22*V00) - sig_y*(U00*V22 + U02*V20)*(U20*V02 + U22*V00) + sig_z*(U00*V21 - U01*V20)*(U20*V01 - U21*V00) - sig_z*(U00*V21 + U01*V20)*(U20*V01 + U21*V00)) + d7*(2*l0*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U11*V22 - U12*V21)*(U21*V02 - U22*V01) - sig_x*(U11*V22 + U12*V21)*(U21*V02 + U22*V01) + sig_y*(U10*V22 - U12*V20)*(U20*V02 - U22*V00) - sig_y*(U10*V22 + U12*V20)*(U20*V02 + U22*V00) + sig_z*(U10*V21 - U11*V20)*(U20*V01 - U21*V00) - sig_z*(U10*V21 + U11*V20)*(U20*V01 + U21*V00)) + d8*(2*l0*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U21*V02 - U22*V01)*(U21*V22 - U22*V21) - sig_x*(U21*V02 + U22*V01)*(U21*V22 + U22*V21) + sig_y*(U20*V02 - U22*V00)*(U20*V22 - U22*V20) - sig_y*(U20*V02 + U22*V00)*(U20*V22 + U22*V20) + sig_z*(U20*V01 - U21*V00)*(U20*V21 - U21*V20) - sig_z*(U20*V01 + U21*V00)*(U20*V21 + U21*V20)))/2 + d3*(d0*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U01*V12 - U02*V11) - sig_x*(U01*V02 + U02*V01)*(U01*V12 + U02*V11) + sig_y*(U00*V02 - U02*V00)*(U00*V12 - U02*V10) - sig_y*(U00*V02 + U02*V00)*(U00*V12 + U02*V10) + sig_z*(U00*V01 - U01*V00)*(U00*V11 - U01*V10) - sig_z*(U00*V01 + U01*V00)*(U00*V11 + U01*V10)) + d1*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U11*V02 - U12*V01) - sig_x*(U01*V12 + U02*V11)*(U11*V02 + U12*V01) + sig_y*(U00*V12 - U02*V10)*(U10*V02 - U12*V00) - sig_y*(U00*V12 + U02*V10)*(U10*V02 + U12*V00) + sig_z*(U00*V11 - U01*V10)*(U10*V01 - U11*V00) - sig_z*(U00*V11 + U01*V10)*(U10*V01 + U11*V00)) + d2*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U21*V02 - U22*V01) - sig_x*(U01*V12 + U02*V11)*(U21*V02 + U22*V01) + sig_y*(U00*V12 - U02*V10)*(U20*V02 - U22*V00) - sig_y*(U00*V12 + U02*V10)*(U20*V02 + U22*V00) + sig_z*(U00*V11 - U01*V10)*(U20*V01 - U21*V00) - sig_z*(U00*V11 + U01*V10)*(U20*V01 + U21*V00)) + d3*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))**2 + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))**2 + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))**2 + sig_x*(U01*V12 - U02*V11)**2 - sig_x*(U01*V12 + U02*V11)**2 + sig_y*(U00*V12 - U02*V10)**2 - sig_y*(U00*V12 + U02*V10)**2 + sig_z*(U00*V11 - U01*V10)**2 - sig_z*(U00*V11 + U01*V10)**2) + d4*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U11*V12 - U12*V11) - sig_x*(U01*V12 + U02*V11)*(U11*V12 + U12*V11) + sig_y*(U00*V12 - U02*V10)*(U10*V12 - U12*V10) - sig_y*(U00*V12 + U02*V10)*(U10*V12 + U12*V10) + sig_z*(U00*V11 - U01*V10)*(U10*V11 - U11*V10) - sig_z*(U00*V11 + U01*V10)*(U10*V11 + U11*V10)) + d5*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U21*V12 - U22*V11) - sig_x*(U01*V12 + U02*V11)*(U21*V12 + U22*V11) + sig_y*(U00*V12 - U02*V10)*(U20*V12 - U22*V10) - sig_y*(U00*V12 + U02*V10)*(U20*V12 + U22*V10) + sig_z*(U00*V11 - U01*V10)*(U20*V11 - U21*V10) - sig_z*(U00*V11 + U01*V10)*(U20*V11 + U21*V10)) + d6*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U01*V22 - U02*V21) - sig_x*(U01*V12 + U02*V11)*(U01*V22 + U02*V21) + sig_y*(U00*V12 - U02*V10)*(U00*V22 - U02*V20) - sig_y*(U00*V12 + U02*V10)*(U00*V22 + U02*V20) + sig_z*(U00*V11 - U01*V10)*(U00*V21 - U01*V20) - sig_z*(U00*V11 + U01*V10)*(U00*V21 + U01*V20)) + d7*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U11*V22 - U12*V21) - sig_x*(U01*V12 + U02*V11)*(U11*V22 + U12*V21) + sig_y*(U00*V12 - U02*V10)*(U10*V22 - U12*V20) - sig_y*(U00*V12 + U02*V10)*(U10*V22 + U12*V20) + sig_z*(U00*V11 - U01*V10)*(U10*V21 - U11*V20) - sig_z*(U00*V11 + U01*V10)*(U10*V21 + U11*V20)) + d8*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U21*V22 - U22*V21) - sig_x*(U01*V12 + U02*V11)*(U21*V22 + U22*V21) + sig_y*(U00*V12 - U02*V10)*(U20*V22 - U22*V20) - sig_y*(U00*V12 + U02*V10)*(U20*V22 + U22*V20) + sig_z*(U00*V11 - U01*V10)*(U20*V21 - U21*V20) - sig_z*(U00*V11 + U01*V10)*(U20*V21 + U21*V20)))/2 + d4*(d0*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U11*V12 - U12*V11) - sig_x*(U01*V02 + U02*V01)*(U11*V12 + U12*V11) + sig_y*(U00*V02 - U02*V00)*(U10*V12 - U12*V10) - sig_y*(U00*V02 + U02*V00)*(U10*V12 + U12*V10) + sig_z*(U00*V01 - U01*V00)*(U10*V11 - U11*V10) - sig_z*(U00*V01 + U01*V00)*(U10*V11 + U11*V10)) + d1*(2*l0*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2))*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2)) + 2*l1*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2))*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2)) + 2*l2*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2))*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2)) + sig_x*(U11*V02 - U12*V01)*(U11*V12 - U12*V11) - sig_x*(U11*V02 + U12*V01)*(U11*V12 + U12*V11) + sig_y*(U10*V02 - U12*V00)*(U10*V12 - U12*V10) - sig_y*(U10*V02 + U12*V00)*(U10*V12 + U12*V10) + sig_z*(U10*V01 - U11*V00)*(U10*V11 - U11*V10) - sig_z*(U10*V01 + U11*V00)*(U10*V11 + U11*V10)) + d2*(2*l0*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U11*V12 - U12*V11)*(U21*V02 - U22*V01) - sig_x*(U11*V12 + U12*V11)*(U21*V02 + U22*V01) + sig_y*(U10*V12 - U12*V10)*(U20*V02 - U22*V00) - sig_y*(U10*V12 + U12*V10)*(U20*V02 + U22*V00) + sig_z*(U10*V11 - U11*V10)*(U20*V01 - U21*V00) - sig_z*(U10*V11 + U11*V10)*(U20*V01 + U21*V00)) + d3*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U11*V12 - U12*V11) - sig_x*(U01*V12 + U02*V11)*(U11*V12 + U12*V11) + sig_y*(U00*V12 - U02*V10)*(U10*V12 - U12*V10) - sig_y*(U00*V12 + U02*V10)*(U10*V12 + U12*V10) + sig_z*(U00*V11 - U01*V10)*(U10*V11 - U11*V10) - sig_z*(U00*V11 + U01*V10)*(U10*V11 + U11*V10)) + d4*(2*l0*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2))**2 + 2*l1*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2))**2 + 2*l2*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2))**2 + sig_x*(U11*V12 - U12*V11)**2 - sig_x*(U11*V12 + U12*V11)**2 + sig_y*(U10*V12 - U12*V10)**2 - sig_y*(U10*V12 + U12*V10)**2 + sig_z*(U10*V11 - U11*V10)**2 - sig_z*(U10*V11 + U11*V10)**2) + d5*(2*l0*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U11*V12 - U12*V11)*(U21*V12 - U22*V11) - sig_x*(U11*V12 + U12*V11)*(U21*V12 + U22*V11) + sig_y*(U10*V12 - U12*V10)*(U20*V12 - U22*V10) - sig_y*(U10*V12 + U12*V10)*(U20*V12 + U22*V10) + sig_z*(U10*V11 - U11*V10)*(U20*V11 - U21*V10) - sig_z*(U10*V11 + U11*V10)*(U20*V11 + U21*V10)) + d6*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U11*V12 - U12*V11) - sig_x*(U01*V22 + U02*V21)*(U11*V12 + U12*V11) + sig_y*(U00*V22 - U02*V20)*(U10*V12 - U12*V10) - sig_y*(U00*V22 + U02*V20)*(U10*V12 + U12*V10) + sig_z*(U00*V21 - U01*V20)*(U10*V11 - U11*V10) - sig_z*(U00*V21 + U01*V20)*(U10*V11 + U11*V10)) + d7*(2*l0*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2))*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2)) + 2*l1*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2))*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2)) + 2*l2*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2))*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2)) + sig_x*(U11*V12 - U12*V11)*(U11*V22 - U12*V21) - sig_x*(U11*V12 + U12*V11)*(U11*V22 + U12*V21) + sig_y*(U10*V12 - U12*V10)*(U10*V22 - U12*V20) - sig_y*(U10*V12 + U12*V10)*(U10*V22 + U12*V20) + sig_z*(U10*V11 - U11*V10)*(U10*V21 - U11*V20) - sig_z*(U10*V11 + U11*V10)*(U10*V21 + U11*V20)) + d8*(2*l0*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U11*V12 - U12*V11)*(U21*V22 - U22*V21) - sig_x*(U11*V12 + U12*V11)*(U21*V22 + U22*V21) + sig_y*(U10*V12 - U12*V10)*(U20*V22 - U22*V20) - sig_y*(U10*V12 + U12*V10)*(U20*V22 + U22*V20) + sig_z*(U10*V11 - U11*V10)*(U20*V21 - U21*V20) - sig_z*(U10*V11 + U11*V10)*(U20*V21 + U21*V20)))/2 + d5*(d0*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U21*V12 - U22*V11) - sig_x*(U01*V02 + U02*V01)*(U21*V12 + U22*V11) + sig_y*(U00*V02 - U02*V00)*(U20*V12 - U22*V10) - sig_y*(U00*V02 + U02*V00)*(U20*V12 + U22*V10) + sig_z*(U00*V01 - U01*V00)*(U20*V11 - U21*V10) - sig_z*(U00*V01 + U01*V00)*(U20*V11 + U21*V10)) + d1*(2*l0*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U11*V02 - U12*V01)*(U21*V12 - U22*V11) - sig_x*(U11*V02 + U12*V01)*(U21*V12 + U22*V11) + sig_y*(U10*V02 - U12*V00)*(U20*V12 - U22*V10) - sig_y*(U10*V02 + U12*V00)*(U20*V12 + U22*V10) + sig_z*(U10*V01 - U11*V00)*(U20*V11 - U21*V10) - sig_z*(U10*V01 + U11*V00)*(U20*V11 + U21*V10)) + d2*(2*l0*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U21*V02 - U22*V01)*(U21*V12 - U22*V11) - sig_x*(U21*V02 + U22*V01)*(U21*V12 + U22*V11) + sig_y*(U20*V02 - U22*V00)*(U20*V12 - U22*V10) - sig_y*(U20*V02 + U22*V00)*(U20*V12 + U22*V10) + sig_z*(U20*V01 - U21*V00)*(U20*V11 - U21*V10) - sig_z*(U20*V01 + U21*V00)*(U20*V11 + U21*V10)) + d3*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U21*V12 - U22*V11) - sig_x*(U01*V12 + U02*V11)*(U21*V12 + U22*V11) + sig_y*(U00*V12 - U02*V10)*(U20*V12 - U22*V10) - sig_y*(U00*V12 + U02*V10)*(U20*V12 + U22*V10) + sig_z*(U00*V11 - U01*V10)*(U20*V11 - U21*V10) - sig_z*(U00*V11 + U01*V10)*(U20*V11 + U21*V10)) + d4*(2*l0*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U11*V12 - U12*V11)*(U21*V12 - U22*V11) - sig_x*(U11*V12 + U12*V11)*(U21*V12 + U22*V11) + sig_y*(U10*V12 - U12*V10)*(U20*V12 - U22*V10) - sig_y*(U10*V12 + U12*V10)*(U20*V12 + U22*V10) + sig_z*(U10*V11 - U11*V10)*(U20*V11 - U21*V10) - sig_z*(U10*V11 + U11*V10)*(U20*V11 + U21*V10)) + d5*(2*l0*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2))**2 + 2*l1*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2))**2 + 2*l2*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2))**2 + sig_x*(U21*V12 - U22*V11)**2 - sig_x*(U21*V12 + U22*V11)**2 + sig_y*(U20*V12 - U22*V10)**2 - sig_y*(U20*V12 + U22*V10)**2 + sig_z*(U20*V11 - U21*V10)**2 - sig_z*(U20*V11 + U21*V10)**2) + d6*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U21*V12 - U22*V11) - sig_x*(U01*V22 + U02*V21)*(U21*V12 + U22*V11) + sig_y*(U00*V22 - U02*V20)*(U20*V12 - U22*V10) - sig_y*(U00*V22 + U02*V20)*(U20*V12 + U22*V10) + sig_z*(U00*V21 - U01*V20)*(U20*V11 - U21*V10) - sig_z*(U00*V21 + U01*V20)*(U20*V11 + U21*V10)) + d7*(2*l0*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U11*V22 - U12*V21)*(U21*V12 - U22*V11) - sig_x*(U11*V22 + U12*V21)*(U21*V12 + U22*V11) + sig_y*(U10*V22 - U12*V20)*(U20*V12 - U22*V10) - sig_y*(U10*V22 + U12*V20)*(U20*V12 + U22*V10) + sig_z*(U10*V21 - U11*V20)*(U20*V11 - U21*V10) - sig_z*(U10*V21 + U11*V20)*(U20*V11 + U21*V10)) + d8*(2*l0*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U21*V12 - U22*V11)*(U21*V22 - U22*V21) - sig_x*(U21*V12 + U22*V11)*(U21*V22 + U22*V21) + sig_y*(U20*V12 - U22*V10)*(U20*V22 - U22*V20) - sig_y*(U20*V12 + U22*V10)*(U20*V22 + U22*V20) + sig_z*(U20*V11 - U21*V10)*(U20*V21 - U21*V20) - sig_z*(U20*V11 + U21*V10)*(U20*V21 + U21*V20)))/2 + d6*(d0*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U01*V22 - U02*V21) - sig_x*(U01*V02 + U02*V01)*(U01*V22 + U02*V21) + sig_y*(U00*V02 - U02*V00)*(U00*V22 - U02*V20) - sig_y*(U00*V02 + U02*V00)*(U00*V22 + U02*V20) + sig_z*(U00*V01 - U01*V00)*(U00*V21 - U01*V20) - sig_z*(U00*V01 + U01*V00)*(U00*V21 + U01*V20)) + d1*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U11*V02 - U12*V01) - sig_x*(U01*V22 + U02*V21)*(U11*V02 + U12*V01) + sig_y*(U00*V22 - U02*V20)*(U10*V02 - U12*V00) - sig_y*(U00*V22 + U02*V20)*(U10*V02 + U12*V00) + sig_z*(U00*V21 - U01*V20)*(U10*V01 - U11*V00) - sig_z*(U00*V21 + U01*V20)*(U10*V01 + U11*V00)) + d2*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U21*V02 - U22*V01) - sig_x*(U01*V22 + U02*V21)*(U21*V02 + U22*V01) + sig_y*(U00*V22 - U02*V20)*(U20*V02 - U22*V00) - sig_y*(U00*V22 + U02*V20)*(U20*V02 + U22*V00) + sig_z*(U00*V21 - U01*V20)*(U20*V01 - U21*V00) - sig_z*(U00*V21 + U01*V20)*(U20*V01 + U21*V00)) + d3*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U01*V22 - U02*V21) - sig_x*(U01*V12 + U02*V11)*(U01*V22 + U02*V21) + sig_y*(U00*V12 - U02*V10)*(U00*V22 - U02*V20) - sig_y*(U00*V12 + U02*V10)*(U00*V22 + U02*V20) + sig_z*(U00*V11 - U01*V10)*(U00*V21 - U01*V20) - sig_z*(U00*V11 + U01*V10)*(U00*V21 + U01*V20)) + d4*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U11*V12 - U12*V11) - sig_x*(U01*V22 + U02*V21)*(U11*V12 + U12*V11) + sig_y*(U00*V22 - U02*V20)*(U10*V12 - U12*V10) - sig_y*(U00*V22 + U02*V20)*(U10*V12 + U12*V10) + sig_z*(U00*V21 - U01*V20)*(U10*V11 - U11*V10) - sig_z*(U00*V21 + U01*V20)*(U10*V11 + U11*V10)) + d5*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U21*V12 - U22*V11) - sig_x*(U01*V22 + U02*V21)*(U21*V12 + U22*V11) + sig_y*(U00*V22 - U02*V20)*(U20*V12 - U22*V10) - sig_y*(U00*V22 + U02*V20)*(U20*V12 + U22*V10) + sig_z*(U00*V21 - U01*V20)*(U20*V11 - U21*V10) - sig_z*(U00*V21 + U01*V20)*(U20*V11 + U21*V10)) + d6*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))**2 + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))**2 + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))**2 + sig_x*(U01*V22 - U02*V21)**2 - sig_x*(U01*V22 + U02*V21)**2 + sig_y*(U00*V22 - U02*V20)**2 - sig_y*(U00*V22 + U02*V20)**2 + sig_z*(U00*V21 - U01*V20)**2 - sig_z*(U00*V21 + U01*V20)**2) + d7*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U11*V22 - U12*V21) - sig_x*(U01*V22 + U02*V21)*(U11*V22 + U12*V21) + sig_y*(U00*V22 - U02*V20)*(U10*V22 - U12*V20) - sig_y*(U00*V22 + U02*V20)*(U10*V22 + U12*V20) + sig_z*(U00*V21 - U01*V20)*(U10*V21 - U11*V20) - sig_z*(U00*V21 + U01*V20)*(U10*V21 + U11*V20)) + d8*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U21*V22 - U22*V21) - sig_x*(U01*V22 + U02*V21)*(U21*V22 + U22*V21) + sig_y*(U00*V22 - U02*V20)*(U20*V22 - U22*V20) - sig_y*(U00*V22 + U02*V20)*(U20*V22 + U22*V20) + sig_z*(U00*V21 - U01*V20)*(U20*V21 - U21*V20) - sig_z*(U00*V21 + U01*V20)*(U20*V21 + U21*V20)))/2 + d7*(d0*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U11*V22 - U12*V21) - sig_x*(U01*V02 + U02*V01)*(U11*V22 + U12*V21) + sig_y*(U00*V02 - U02*V00)*(U10*V22 - U12*V20) - sig_y*(U00*V02 + U02*V00)*(U10*V22 + U12*V20) + sig_z*(U00*V01 - U01*V00)*(U10*V21 - U11*V20) - sig_z*(U00*V01 + U01*V00)*(U10*V21 + U11*V20)) + d1*(2*l0*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2))*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2)) + 2*l1*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2))*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2)) + 2*l2*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2))*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2)) + sig_x*(U11*V02 - U12*V01)*(U11*V22 - U12*V21) - sig_x*(U11*V02 + U12*V01)*(U11*V22 + U12*V21) + sig_y*(U10*V02 - U12*V00)*(U10*V22 - U12*V20) - sig_y*(U10*V02 + U12*V00)*(U10*V22 + U12*V20) + sig_z*(U10*V01 - U11*V00)*(U10*V21 - U11*V20) - sig_z*(U10*V01 + U11*V00)*(U10*V21 + U11*V20)) + d2*(2*l0*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2))*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2)) + 2*l1*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2))*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2)) + 2*l2*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2))*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2)) + sig_x*(U11*V22 - U12*V21)*(U21*V02 - U22*V01) - sig_x*(U11*V22 + U12*V21)*(U21*V02 + U22*V01) + sig_y*(U10*V22 - U12*V20)*(U20*V02 - U22*V00) - sig_y*(U10*V22 + U12*V20)*(U20*V02 + U22*V00) + sig_z*(U10*V21 - U11*V20)*(U20*V01 - U21*V00) - sig_z*(U10*V21 + U11*V20)*(U20*V01 + U21*V00)) + d3*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U11*V22 - U12*V21) - sig_x*(U01*V12 + U02*V11)*(U11*V22 + U12*V21) + sig_y*(U00*V12 - U02*V10)*(U10*V22 - U12*V20) - sig_y*(U00*V12 + U02*V10)*(U10*V22 + U12*V20) + sig_z*(U00*V11 - U01*V10)*(U10*V21 - U11*V20) - sig_z*(U00*V11 + U01*V10)*(U10*V21 + U11*V20)) + d4*(2*l0*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2))*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2)) + 2*l1*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2))*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2)) + 2*l2*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2))*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2)) + sig_x*(U11*V12 - U12*V11)*(U11*V22 - U12*V21) - sig_x*(U11*V12 + U12*V11)*(U11*V22 + U12*V21) + sig_y*(U10*V12 - U12*V10)*(U10*V22 - U12*V20) - sig_y*(U10*V12 + U12*V10)*(U10*V22 + U12*V20) + sig_z*(U10*V11 - U11*V10)*(U10*V21 - U11*V20) - sig_z*(U10*V11 + U11*V10)*(U10*V21 + U11*V20)) + d5*(2*l0*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2))*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2)) + 2*l1*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2))*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2)) + 2*l2*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2))*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2)) + sig_x*(U11*V22 - U12*V21)*(U21*V12 - U22*V11) - sig_x*(U11*V22 + U12*V21)*(U21*V12 + U22*V11) + sig_y*(U10*V22 - U12*V20)*(U20*V12 - U22*V10) - sig_y*(U10*V22 + U12*V20)*(U20*V12 + U22*V10) + sig_z*(U10*V21 - U11*V20)*(U20*V11 - U21*V10) - sig_z*(U10*V21 + U11*V20)*(U20*V11 + U21*V10)) + d6*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U11*V22 - U12*V21) - sig_x*(U01*V22 + U02*V21)*(U11*V22 + U12*V21) + sig_y*(U00*V22 - U02*V20)*(U10*V22 - U12*V20) - sig_y*(U00*V22 + U02*V20)*(U10*V22 + U12*V20) + sig_z*(U00*V21 - U01*V20)*(U10*V21 - U11*V20) - sig_z*(U00*V21 + U01*V20)*(U10*V21 + U11*V20)) + d7*(2*l0*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2))**2 + 2*l1*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2))**2 + 2*l2*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2))**2 + sig_x*(U11*V22 - U12*V21)**2 - sig_x*(U11*V22 + U12*V21)**2 + sig_y*(U10*V22 - U12*V20)**2 - sig_y*(U10*V22 + U12*V20)**2 + sig_z*(U10*V21 - U11*V20)**2 - sig_z*(U10*V21 + U11*V20)**2) + d8*(2*l0*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U11*V22 - U12*V21)*(U21*V22 - U22*V21) - sig_x*(U11*V22 + U12*V21)*(U21*V22 + U22*V21) + sig_y*(U10*V22 - U12*V20)*(U20*V22 - U22*V20) - sig_y*(U10*V22 + U12*V20)*(U20*V22 + U22*V20) + sig_z*(U10*V21 - U11*V20)*(U20*V21 - U21*V20) - sig_z*(U10*V21 + U11*V20)*(U20*V21 + U21*V20)))/2 + d8*(d0*(2*l0*(U00*V00*(l0*sig_y + sig_x*sig_z) + U01*V01*(l0*sig_x + sig_y*sig_z) + U02*V02*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V00*(l1*sig_y + sig_x*sig_z) + U01*V01*(l1*sig_x + sig_y*sig_z) + U02*V02*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V00*(l2*sig_y + sig_x*sig_z) + U01*V01*(l2*sig_x + sig_y*sig_z) + U02*V02*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V02 - U02*V01)*(U21*V22 - U22*V21) - sig_x*(U01*V02 + U02*V01)*(U21*V22 + U22*V21) + sig_y*(U00*V02 - U02*V00)*(U20*V22 - U22*V20) - sig_y*(U00*V02 + U02*V00)*(U20*V22 + U22*V20) + sig_z*(U00*V01 - U01*V00)*(U20*V21 - U21*V20) - sig_z*(U00*V01 + U01*V00)*(U20*V21 + U21*V20)) + d1*(2*l0*(U10*V00*(l0*sig_y + sig_x*sig_z) + U11*V01*(l0*sig_x + sig_y*sig_z) + U12*V02*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U10*V00*(l1*sig_y + sig_x*sig_z) + U11*V01*(l1*sig_x + sig_y*sig_z) + U12*V02*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U10*V00*(l2*sig_y + sig_x*sig_z) + U11*V01*(l2*sig_x + sig_y*sig_z) + U12*V02*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U11*V02 - U12*V01)*(U21*V22 - U22*V21) - sig_x*(U11*V02 + U12*V01)*(U21*V22 + U22*V21) + sig_y*(U10*V02 - U12*V00)*(U20*V22 - U22*V20) - sig_y*(U10*V02 + U12*V00)*(U20*V22 + U22*V20) + sig_z*(U10*V01 - U11*V00)*(U20*V21 - U21*V20) - sig_z*(U10*V01 + U11*V00)*(U20*V21 + U21*V20)) + d2*(2*l0*(U20*V00*(l0*sig_y + sig_x*sig_z) + U21*V01*(l0*sig_x + sig_y*sig_z) + U22*V02*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U20*V00*(l1*sig_y + sig_x*sig_z) + U21*V01*(l1*sig_x + sig_y*sig_z) + U22*V02*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U20*V00*(l2*sig_y + sig_x*sig_z) + U21*V01*(l2*sig_x + sig_y*sig_z) + U22*V02*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U21*V02 - U22*V01)*(U21*V22 - U22*V21) - sig_x*(U21*V02 + U22*V01)*(U21*V22 + U22*V21) + sig_y*(U20*V02 - U22*V00)*(U20*V22 - U22*V20) - sig_y*(U20*V02 + U22*V00)*(U20*V22 + U22*V20) + sig_z*(U20*V01 - U21*V00)*(U20*V21 - U21*V20) - sig_z*(U20*V01 + U21*V00)*(U20*V21 + U21*V20)) + d3*(2*l0*(U00*V10*(l0*sig_y + sig_x*sig_z) + U01*V11*(l0*sig_x + sig_y*sig_z) + U02*V12*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V10*(l1*sig_y + sig_x*sig_z) + U01*V11*(l1*sig_x + sig_y*sig_z) + U02*V12*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V10*(l2*sig_y + sig_x*sig_z) + U01*V11*(l2*sig_x + sig_y*sig_z) + U02*V12*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V12 - U02*V11)*(U21*V22 - U22*V21) - sig_x*(U01*V12 + U02*V11)*(U21*V22 + U22*V21) + sig_y*(U00*V12 - U02*V10)*(U20*V22 - U22*V20) - sig_y*(U00*V12 + U02*V10)*(U20*V22 + U22*V20) + sig_z*(U00*V11 - U01*V10)*(U20*V21 - U21*V20) - sig_z*(U00*V11 + U01*V10)*(U20*V21 + U21*V20)) + d4*(2*l0*(U10*V10*(l0*sig_y + sig_x*sig_z) + U11*V11*(l0*sig_x + sig_y*sig_z) + U12*V12*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U10*V10*(l1*sig_y + sig_x*sig_z) + U11*V11*(l1*sig_x + sig_y*sig_z) + U12*V12*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U10*V10*(l2*sig_y + sig_x*sig_z) + U11*V11*(l2*sig_x + sig_y*sig_z) + U12*V12*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U11*V12 - U12*V11)*(U21*V22 - U22*V21) - sig_x*(U11*V12 + U12*V11)*(U21*V22 + U22*V21) + sig_y*(U10*V12 - U12*V10)*(U20*V22 - U22*V20) - sig_y*(U10*V12 + U12*V10)*(U20*V22 + U22*V20) + sig_z*(U10*V11 - U11*V10)*(U20*V21 - U21*V20) - sig_z*(U10*V11 + U11*V10)*(U20*V21 + U21*V20)) + d5*(2*l0*(U20*V10*(l0*sig_y + sig_x*sig_z) + U21*V11*(l0*sig_x + sig_y*sig_z) + U22*V12*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U20*V10*(l1*sig_y + sig_x*sig_z) + U21*V11*(l1*sig_x + sig_y*sig_z) + U22*V12*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U20*V10*(l2*sig_y + sig_x*sig_z) + U21*V11*(l2*sig_x + sig_y*sig_z) + U22*V12*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U21*V12 - U22*V11)*(U21*V22 - U22*V21) - sig_x*(U21*V12 + U22*V11)*(U21*V22 + U22*V21) + sig_y*(U20*V12 - U22*V10)*(U20*V22 - U22*V20) - sig_y*(U20*V12 + U22*V10)*(U20*V22 + U22*V20) + sig_z*(U20*V11 - U21*V10)*(U20*V21 - U21*V20) - sig_z*(U20*V11 + U21*V10)*(U20*V21 + U21*V20)) + d6*(2*l0*(U00*V20*(l0*sig_y + sig_x*sig_z) + U01*V21*(l0*sig_x + sig_y*sig_z) + U02*V22*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U00*V20*(l1*sig_y + sig_x*sig_z) + U01*V21*(l1*sig_x + sig_y*sig_z) + U02*V22*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U00*V20*(l2*sig_y + sig_x*sig_z) + U01*V21*(l2*sig_x + sig_y*sig_z) + U02*V22*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U01*V22 - U02*V21)*(U21*V22 - U22*V21) - sig_x*(U01*V22 + U02*V21)*(U21*V22 + U22*V21) + sig_y*(U00*V22 - U02*V20)*(U20*V22 - U22*V20) - sig_y*(U00*V22 + U02*V20)*(U20*V22 + U22*V20) + sig_z*(U00*V21 - U01*V20)*(U20*V21 - U21*V20) - sig_z*(U00*V21 + U01*V20)*(U20*V21 + U21*V20)) + d7*(2*l0*(U10*V20*(l0*sig_y + sig_x*sig_z) + U11*V21*(l0*sig_x + sig_y*sig_z) + U12*V22*(l0**2 - sig_z**2))*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2)) + 2*l1*(U10*V20*(l1*sig_y + sig_x*sig_z) + U11*V21*(l1*sig_x + sig_y*sig_z) + U12*V22*(l1**2 - sig_z**2))*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2)) + 2*l2*(U10*V20*(l2*sig_y + sig_x*sig_z) + U11*V21*(l2*sig_x + sig_y*sig_z) + U12*V22*(l2**2 - sig_z**2))*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2)) + sig_x*(U11*V22 - U12*V21)*(U21*V22 - U22*V21) - sig_x*(U11*V22 + U12*V21)*(U21*V22 + U22*V21) + sig_y*(U10*V22 - U12*V20)*(U20*V22 - U22*V20) - sig_y*(U10*V22 + U12*V20)*(U20*V22 + U22*V20) + sig_z*(U10*V21 - U11*V20)*(U20*V21 - U21*V20) - sig_z*(U10*V21 + U11*V20)*(U20*V21 + U21*V20)) + d8*(2*l0*(U20*V20*(l0*sig_y + sig_x*sig_z) + U21*V21*(l0*sig_x + sig_y*sig_z) + U22*V22*(l0**2 - sig_z**2))**2 + 2*l1*(U20*V20*(l1*sig_y + sig_x*sig_z) + U21*V21*(l1*sig_x + sig_y*sig_z) + U22*V22*(l1**2 - sig_z**2))**2 + 2*l2*(U20*V20*(l2*sig_y + sig_x*sig_z) + U21*V21*(l2*sig_x + sig_y*sig_z) + U22*V22*(l2**2 - sig_z**2))**2 + sig_x*(U21*V22 - U22*V21)**2 - sig_x*(U21*V22 + U22*V21)**2 + sig_y*(U20*V22 - U22*V20)**2 - sig_y*(U20*V22 + U22*V20)**2 + sig_z*(U20*V21 - U21*V20)**2 - sig_z*(U20*V21 + U21*V20)**2))/2

# def test11():
    # dFdx^T H_9x9 dFdx



test7()
# d2PsidF2 = sympy.MatrixSymbol('H',9,9)
# tmp = sympy.MatMul(d2PsidF2,dFdx)
# d2Psidx2 = sympy.MatMul(dFdx.transpose(), tmp)
# tmp = d2PsidF2
# d2Psidx2 = (dFdx.transpose().multiply(d2PsidF2)).multiply(dFdx)
# for i in range(12):
#     simp = simplify(d2Psidx2[i,i])
#     print(simp)

# for i in range(12):
#     for j in range(12):
#         simp = simplify(d2Psidx2[i,i])
#         print('i,j', i,j, simp)

#
# print('diag 3x3')
# RR = R.multiply(R.transpose())
# RR_simp = simplify(RR)
# for i in range(4):
#     print(RR_simp[i*3, i*3:i*3+3])
#     print(RR_simp[i*3+1, i*3:i*3+3])
#     print(RR_simp[i*3+2, i*3:i*3+3])
#
#
#
#
# # R2 = dFdx.transpose().multiply(dFdx)
# # R2_simp = simplify(R2)
# # for i in range(12):
# #     print(R2_simp[i,i])
# #
# # p0, p1,  p2,  p3,  p4,  p5,  p6,  p7,  p8,  p9,  p10, p11 = sympy.symbols('p0,  p1,  p2,  p3,  p4,  p5,  p6,  p7,  p8,  p9,  p10, p11')
# # p =  sympy.Matrix([p0, p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11])
# # print(p.shape)
# # R3 = dFdx.multiply(p)
# # R3_simp = simplify(R3)
# # print(R3_simp)
# print('___________________________________')
